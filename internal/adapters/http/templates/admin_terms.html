{{ define "content" }}
<div class="card">
    <h1>Term Management</h1>

    <div style="background:#f8f9fa;padding:1.5rem;border-radius:2px;margin-bottom:2rem;">
        <h3 style="margin-top:0;">Add Term</h3>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:1rem;">
            <div class="form-group">
                <label>Name</label>
                <input type="text" id="termName" placeholder="Term 1 2026" maxlength="100">
            </div>
            <div class="form-group">
                <label>Start Date</label>
                <input type="text" id="termStart" placeholder="2026-01-27">
            </div>
            <div class="form-group">
                <label>End Date</label>
                <input type="text" id="termEnd" placeholder="2026-04-17">
            </div>
        </div>
        <button onclick="createTerm()">Add Term</button>
        <span id="formMsg" style="margin-left:1rem;color:#F9B232;"></span>
    </div>

    <h2>Terms</h2>
    <table style="width:100%;border-collapse:collapse;">
        <thead>
            <tr style="background:#f8f9fa;border-bottom:2px solid #dee2e6;">
                <th style="padding:0.5rem;text-align:left;">Name</th>
                <th style="padding:0.5rem;text-align:left;">Start</th>
                <th style="padding:0.5rem;text-align:left;">End</th>
                <th style="padding:0.5rem;text-align:right;">Actions</th>
            </tr>
        </thead>
        <tbody id="termBody">
            <tr><td colspan="4" style="padding:1rem;color:#6c757d;text-align:center;">Loading...</td></tr>
        </tbody>
    </table>

    <p style="margin-top:2rem;"><a href="/dashboard" style="color:#F9B232;text-decoration:none;font-weight:600;">‚Üê Back to Dashboard</a></p>
</div>

<script>
function loadTerms() {
    fetch('/api/terms').then(r=>r.json()).then(data => {
        var b = document.getElementById('termBody');
        if (!data||data.length===0) { b.innerHTML='<tr><td colspan="4" style="padding:1rem;color:#6c757d;text-align:center;">No terms.</td></tr>'; return; }
        b.innerHTML='';
        data.forEach(t => {
            b.innerHTML+='<tr style="border-bottom:1px solid #dee2e6;">'+
                '<td style="padding:0.5rem;font-weight:600;">'+t.Name+'</td>'+
                '<td style="padding:0.5rem;">'+t.StartDate.substring(0,10)+'</td>'+
                '<td style="padding:0.5rem;">'+t.EndDate.substring(0,10)+'</td>'+
                '<td style="padding:0.5rem;text-align:right;"><button onclick="deleteTerm(\''+t.ID+'\')" style="background:#dc3545;padding:0.25rem 0.75rem;font-size:0.85rem;">Delete</button></td></tr>';
        });
    });
}
function createTerm() {
    fetch('/api/terms',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({
        Name:document.getElementById('termName').value,
        StartDate:document.getElementById('termStart').value,
        EndDate:document.getElementById('termEnd').value
    })}).then(r=>{if(!r.ok)throw r;return r.json();})
    .then(()=>{document.getElementById('formMsg').textContent='Created!';loadTerms();setTimeout(()=>document.getElementById('formMsg').textContent='',2000);})
    .catch(()=>document.getElementById('formMsg').textContent='Error');
}
function deleteTerm(id) { fetch('/api/terms?id='+id,{method:'DELETE',headers:{'Content-Type':'application/json'}}).then(()=>loadTerms()); }
loadTerms();
</script>
{{ end }}
