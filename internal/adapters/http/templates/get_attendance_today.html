{{ define "content" }}
<style>
    .belt-icon {
        display: inline-block; width: 18px; height: 10px; border-radius: 2px; margin-right: 4px; vertical-align: middle; border: 1px solid #ccc;
    }
    .belt-white  { background: #fff; }
    .belt-blue   { background: #1565c0; border-color: #1565c0; }
    .belt-purple { background: #7b1fa2; border-color: #7b1fa2; }
    .belt-brown  { background: #5d4037; border-color: #5d4037; }
    .belt-black  { background: #212121; border-color: #212121; }
    .belt-grey   { background: #9e9e9e; border-color: #9e9e9e; }
    .belt-yellow { background: #f9a825; border-color: #f9a825; }
    .belt-orange { background: #e65100; border-color: #e65100; }
    .belt-green  { background: #2e7d32; border-color: #2e7d32; }
    .stripe-dot { display: inline-block; width: 6px; height: 6px; background: #fff; border: 1px solid #999; border-radius: 50%; margin-left: 2px; vertical-align: middle; }
    .date-nav { display: flex; align-items: center; gap: 0.75rem; margin-bottom: 1.5rem; flex-wrap: wrap; }
    .date-nav a, .date-nav button { text-decoration: none; font-weight: 600; padding: 0.4rem 0.75rem; border-radius: 2px; cursor: pointer; font-size: 0.9rem; }
    .date-nav-arrow { background: var(--dark, #333); color: #fff; border: none; }
    .date-nav-arrow:hover { opacity: 0.8; }
    .date-nav-today { background: var(--orange, #e67e22); color: #fff; border: none; }
    .read-only-banner { background: #fff3cd; color: #856404; padding: 0.5rem 1rem; border-radius: 2px; font-size: 0.85rem; font-weight: 600; margin-bottom: 1rem; }
</style>
<div class="card">
    <h1>{{ if .IsToday }}üìä Today's Attendance{{ else }}üìä Attendance{{ end }}</h1>

    <div class="date-nav">
        <a href="/attendance?date={{ .PrevDate }}" class="date-nav-arrow" title="Previous day">&larr;</a>
        <input type="date" id="datePicker" value="{{ .DisplayDate }}" onchange="window.location.href='/attendance?date='+this.value" style="padding:0.4rem;border:1px solid var(--border);border-radius:2px;font-size:0.9rem;">
        <a href="/attendance?date={{ .NextDate }}" class="date-nav-arrow" title="Next day">&rarr;</a>
        {{ if not .IsToday }}
        <a href="/attendance" class="date-nav-today">Back to Today</a>
        {{ end }}
    </div>

    {{ if not .IsToday }}
    <div class="read-only-banner">Viewing past attendance (read-only)</div>
    {{ end }}

    {{ if .Attendees }}
    <p style="color: #666; margin-bottom: 1.5rem;">
        <strong>{{ len .Attendees }}</strong> member(s) checked in{{ if .IsToday }} today{{ else }} on {{ .DisplayDate }}{{ end }}
    </p>

    <table style="width: 100%; border-collapse: collapse; margin: 1rem 0;">
        <thead>
            <tr style="background: #f8f9fa; border-bottom: 2px solid #dee2e6;">
                <th style="padding: 0.75rem; text-align: left;">Member</th>
                <th style="padding: 0.75rem; text-align: left;">Belt</th>
                <th style="padding: 0.75rem; text-align: left;">Check-In</th>
                <th style="padding: 0.75rem; text-align: right;">Mat Hours</th>
                <th style="padding: 0.75rem; text-align: center;">Flags</th>
            </tr>
        </thead>
        <tbody>
            {{ range .Attendees }}
            <tr style="border-bottom: 1px solid #dee2e6;">
                <td style="padding: 0.75rem; font-weight: 600;">{{ .MemberName }}</td>
                <td style="padding: 0.75rem;">
                    {{ if .Belt }}
                    <span class="belt-icon belt-{{ .Belt }}" data-belt="{{ .Belt }}"></span>
                    <span style="font-size: 0.85rem; text-transform: capitalize;">{{ .Belt }}</span>
                    {{ range $i := .Stripe | stripeRange }}
                    <span class="stripe-dot"></span>
                    {{ end }}
                    {{ else }}
                    <span style="color: #999; font-size: 0.85rem;">‚Äî</span>
                    {{ end }}
                </td>
                <td style="padding: 0.75rem; color: #666;">
                    {{ .CheckInTime.Format "3:04 PM" }}
                </td>
                <td style="padding: 0.75rem; text-align: right; color: #666;">
                    {{ if gt .MatHours 0.0 }}{{ printf "%.1f" .MatHours }}h{{ else }}‚Äî{{ end }}
                </td>
                <td style="padding: 0.75rem; text-align: center;">
                    {{ if .HasInjury }}
                    <span
                        style="display: inline-block; padding: 0.25rem 0.75rem; border-radius: 12px; background: #fff3cd; color: #856404; font-weight: 600; font-size: 0.9rem;">
                        üö® {{ .InjuryBodyPart }}
                    </span>
                    {{ else }}
                    <span style="color: #28a745;">‚úì</span>
                    {{ end }}
                </td>
            </tr>
            {{ end }}
        </tbody>
    </table>
    {{ else }}
    <div style="padding: 3rem; text-align: center; background: #f8f9fa; border-radius:2px;">
        <p style="color: #6c757d; font-size: 1.1rem; margin-bottom: 1rem;">No check-ins recorded{{ if .IsToday }} today{{ else }} on {{ .DisplayDate }}{{ end }}</p>
        {{ if .IsToday }}
        <a href="/checkin/form"
            style="display: inline-block; background: #2196f3; color: white; padding: 0.75rem 1.5rem; border-radius:2px; text-decoration: none; font-weight: 600;">
            Check In Member
        </a>
        {{ end }}
    </div>
    {{ end }}

    <div style="margin-top: 2rem; padding-top: 2rem; border-top: 2px solid #f0f0f0;">
        <a href="/dashboard" style="color: #667eea; text-decoration: none; font-weight: 600;">‚Üê Back to Dashboard</a>
        <span style="margin: 0 1rem; color: #dee2e6;">|</span>
        <a href="/members" style="color: #667eea; text-decoration: none; font-weight: 600;">View All Members</a>
    </div>
</div>
{{ end }}