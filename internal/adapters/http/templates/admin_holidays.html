{{ define "content" }}
<div class="card">
    <h1>Holiday Management</h1>

    <div style="background:#f8f9fa;padding:1.5rem;border-radius:2px;margin-bottom:2rem;">
        <h3 style="margin-top:0;">Add Holiday</h3>
        <div style="display:grid;grid-template-columns:1fr 1fr 1fr;gap:1rem;">
            <div class="form-group">
                <label>Name</label>
                <input type="text" id="holName" placeholder="Waitangi Day">
            </div>
            <div class="form-group">
                <label>Start Date</label>
                <input type="text" id="holStart" placeholder="2026-02-06">
            </div>
            <div class="form-group">
                <label>End Date</label>
                <input type="text" id="holEnd" placeholder="2026-02-06">
            </div>
        </div>
        <button onclick="createHoliday()">Add Holiday</button>
        <span id="formMsg" style="margin-left:1rem;color:#F9B232;"></span>
    </div>

    <h2>Holidays</h2>
    <table style="width:100%;border-collapse:collapse;">
        <thead>
            <tr style="background:#f8f9fa;border-bottom:2px solid #dee2e6;">
                <th style="padding:0.5rem;text-align:left;">Name</th>
                <th style="padding:0.5rem;text-align:left;">Start</th>
                <th style="padding:0.5rem;text-align:left;">End</th>
                <th style="padding:0.5rem;text-align:right;">Actions</th>
            </tr>
        </thead>
        <tbody id="holBody">
            <tr><td colspan="4" style="padding:1rem;color:#6c757d;text-align:center;">Loading...</td></tr>
        </tbody>
    </table>

    <p style="margin-top:2rem;"><a href="/dashboard" style="color:#F9B232;text-decoration:none;font-weight:600;">‚Üê Back to Dashboard</a></p>
</div>

<script>
function loadHolidays() {
    fetch('/api/holidays').then(r=>r.json()).then(data => {
        var b = document.getElementById('holBody');
        if (!data||data.length===0) { b.innerHTML='<tr><td colspan="4" style="padding:1rem;color:#6c757d;text-align:center;">No holidays.</td></tr>'; return; }
        b.innerHTML='';
        data.forEach(h => {
            b.innerHTML+='<tr style="border-bottom:1px solid #dee2e6;">'+
                '<td style="padding:0.5rem;font-weight:600;">'+h.Name+'</td>'+
                '<td style="padding:0.5rem;">'+h.StartDate.substring(0,10)+'</td>'+
                '<td style="padding:0.5rem;">'+h.EndDate.substring(0,10)+'</td>'+
                '<td style="padding:0.5rem;text-align:right;"><button onclick="deleteHoliday(\''+h.ID+'\')" style="background:#dc3545;padding:0.25rem 0.75rem;font-size:0.85rem;">Delete</button></td></tr>';
        });
    });
}
function createHoliday() {
    fetch('/api/holidays',{method:'POST',headers:{'Content-Type':'application/json'},body:JSON.stringify({
        Name:document.getElementById('holName').value,
        StartDate:document.getElementById('holStart').value,
        EndDate:document.getElementById('holEnd').value
    })}).then(r=>{if(!r.ok)throw r;return r.json();})
    .then(()=>{document.getElementById('formMsg').textContent='Created!';loadHolidays();setTimeout(()=>document.getElementById('formMsg').textContent='',2000);})
    .catch(()=>document.getElementById('formMsg').textContent='Error');
}
function deleteHoliday(id) { fetch('/api/holidays?id='+id,{method:'DELETE'}).then(()=>loadHolidays()); }
loadHolidays();
</script>
{{ end }}
